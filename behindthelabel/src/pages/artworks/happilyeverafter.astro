---
import Layout from "../../layouts/Layout.astro";
import Happily from "../../components/artworks/Happily.astro";
import { Image } from "astro:assets";
import happily from "../../assets/artworks/happily.png";
import sun from "../../assets/animations/sun.svg";
import thunder from "../../assets/animations/thunder.svg";
import meter from "../../assets/animations/meter.svg";
import bigstar from "../../assets/animations/bigStar.svg";
import eye from "../../assets/animations/eye.svg";
import peel from "../../assets/icon/wiggle.svg";
import scroll from "../../assets/icon/scroll.svg";
---

<Layout>
    <div class="detail">
        <div class="start">
            <h2 class="start__subtitle">
                What is hiding behind the labels of Happily ever after?
            </h2>
            <Happily />
            <p class="start__text">Shake the labels off</p>
            <div class="corner-peel">
                <div class="triangle-mask"></div>
                <div class="triangle-fill"></div>
                <Image class="sticker-wrapper" src={peel} alt="peel" />
            </div>
        </div>
        <div class="story hidden">
            <div id="scrollHint">
                <Image class="scroll" src={scroll} alt="scroll" />
            </div>
            <div class="story__bg"></div>
            <div class="story__subtitles">
                <h2 class="story__subtitle1 top1">This artwork shows</h2>
                <h2 class="story__subtitle1 bottom1">
                    <span class="blue bold">Bissegem</span> in motion
                </h2>
                <h2 class="story__subtitle2 top2">
                    This artwork <span class="blue bold">reflects</span>
                </h2>
                <h2 class="story__subtitle2 bottom2">
                    everything and everyone
                </h2>
                <h2 class="story__subtitle3 top3">
                    <span class="blue bold">Pause</span> for a moment
                </h2>
                <h2 class="story__subtitle3 bottom3">and reflect!</h2>
                <h2 class="story__subtitle4 top4">
                    Where to see <span class="blue bold"
                        >Happily ever after</span
                    >?
                </h2>
            </div>
            <div class="image-wrapper">
                <Image class="image" src={happily} alt="happily" />
            </div>
            <div class="story__animations">
                <div class="story__animation1">
                    <Image class="sun" src={sun} alt="sun" />
                    <p class="shine1">shinnneeee</p>
                    <p class="shine2">shinnneeee</p>
                    <p class="shine3">shinnneeee</p>
                    <Image class="thunder" src={thunder} alt="thunder" />
                    <p class="flash1">flassshhhhh</p>
                    <p class="boom1">boooommmm</p>
                    <p class="flash2">flassshhhhh</p>
                    <p class="boom2">boooommmm</p>
                </div>
                <div class="story__animation2">
                    <Image class="meter" src={meter} alt="meter" />
                    <Image class="bigstar" src={bigstar} alt="bigstar" />
                    <p class="m">16 meter</p>
                    <p class="whut1">whuuuuuttttt</p>
                    <p class="whut2">whuuuuuttttt</p>
                    <p class="whut3">whuuuuuttttt</p>
                </div>
                <div class="story__animation3">
                    <Image class="eye1" src={eye} alt="eye" />
                    <Image class="eye2" src={eye} alt="eye" />
                    <Image class="eye3" src={eye} alt="eye" />
                    <p class="wauw1">WAUUUWWWWWWWW</p>
                    <p class="wauw2">WAUUUWWWWWWWW</p>
                    <p class="wauw3">WAUUUWWWWWWWW</p>
                </div>
            </div>
            <div class="story__texts">
                <p class="story__text1">
                    This isn’t just any mirror. It’s basically a huge mirror
                    artwork that’s always in <span class="bold">motion</span>.
                    It shifts with the light, the <span class="bold"
                        >weather</span
                    >, and even the people who just walk by. Every moment it
                    looks a little different, almost like
                    <span class="bold">it’s alive and reacting to you</span>.
                </p>
                <p class="story__text2">
                    It’s a <span class="bold">16-meter-long</span> iconic landmark
                    that blurs the line between the artwork and its surroundings.
                    The <span class="bold">mirror effect</span>
                    multiplies the newly designed park and gets people interacting
                    with both the space and each other. It doesn’t just <span
                        class="bold">reflect the physical world</span
                    >. It <span class="bold">reflects everyone</span> who’s there
                    too.
                </p>
                <p class="story__text3">
                    The piece invites walkers and cyclists to <span class="bold"
                        >pause for a moment</span
                    >
                    and <span class="bold">reflect</span>. Take a sec to be <span
                        class="bold">aware of the nature</span
                    > around you.
                </p>
            </div>
        </div>
    </div>
    <script>
        import "../../scripts/scroll.js";
    </script>
</Layout>
<style>
    .start__subtitle::after {
        content: "Happily ever after";
        background-color: var(--secondary-color);
        display: flex;
        justify-self: end;
        width: fit-content;
        padding: 0.2rem 0.8rem;
        color: var(--black);
        border-radius: 3rem;
        margin-right: 2rem;
        margin-top: -2rem;
        rotate: -3deg;
        font-size: 1.25rem;
    }

    .sun {
        position: absolute;
        left: -40vw;
        opacity: 0;
    }

    .thunder {
        position: absolute;
        left: 30vw;
        top: 0vh;
        opacity: 0;
    }

    .shine1,
    .shine2,
    .shine3,
    .flash1,
    .flash2,
    .boom1,
    .boom2,
    .whut1,
    .whut2,
    .whut3,
    .wauw1,
    .wauw2,
    .wauw3 {
        background-color: var(--black);
        color: var(--white);
        width: fit-content;
        padding: 0.5rem;
        padding-bottom: 0.6rem;
        text-transform: uppercase;
        font-size: 1.5rem;
        rotate: 10deg;
        position: absolute;
        font-weight: 500;
        font-family: "obviously-narrow", "sans-serif";
        opacity: 0;
    }

    .shine1 {
        top: 30vh;
        right: 5vw;
    }

    .shine2 {
        top: 36vh;
        right: 5vw;
    }

    .shine3 {
        top: 42vh;
        right: 5vw;
    }

    .flash1 {
        top: 25vh;
        left: 5vw;
    }

    .boom1 {
        top: 32vh;
        left: 10vw;
    }

    .flash2 {
        top: 39vh;
        left: 5vw;
    }

    .boom2 {
        top: 47vh;
        left: 10vw;
    }

    .meter {
        position: absolute;
        top: 30vh;
        left: 60vw;
        opacity: 0;
    }

    .bigstar {
        rotate: -12deg;
        position: absolute;
        left: 15vw;
        opacity: 0;
    }

    .m {
        position: absolute;
        font-family: "obviously", "sans-serif";
        font-weight: bold;
        font-size: 1.5rem;
        top: 10vh;
        left: 35vw;
        opacity: 0;
    }

    .whut1 {
        top: 30vh;
        rotate: 0deg;
        left: 40vw;
    }

    .whut2 {
        top: 35vh;
        rotate: 0deg;
        left: 45vw;
    }

    .whut3 {
        top: 40vh;
        rotate: 0deg;
        left: 50vw;
    }

    .eye1 {
        position: absolute;
        top: -5vh;
        left: 50vw;
        rotate: 50deg;
        opacity: 0;
    }

    .eye2 {
        position: absolute;
        top: 5vh;
        left: -5vw;
        opacity: 0;
    }

    .eye3 {
        position: absolute;
        top: 30vh;
        left: 50vw;
        rotate: 30deg;
        opacity: 0;
    }

    .wauw1 {
        rotate: 0deg;
        top: 40vh;
        left: 5vw;
        z-index: 10;
    }

    .wauw2 {
        rotate: 0deg;
        top: 43vh;
        left: 10vw;
        z-index: 9;
    }

    .wauw3 {
        rotate: 0deg;
        top: 46vh;
        left: 15vw;
        z-index: 8;
    }
</style>
<script>
    import { setupScrollAnimations } from "../../scripts/artworks/happily.js";

    const start = document.querySelector(".start");
    const story = document.querySelector(".story");

    if (start && story) {
        let hasShaken = false;
        const threshold = 15;

        const handleMotionEvent = (event: DeviceMotionEvent) => {
            if (hasShaken) return;

            const x = event.accelerationIncludingGravity?.x || 0;
            const y = event.accelerationIncludingGravity?.y || 0;
            const z = event.accelerationIncludingGravity?.z || 0;

            const totalAcceleration = Math.sqrt(x * x + y * y + z * z);

            if (totalAcceleration > threshold) {
                story.classList.remove("hidden");
                start.classList.add("hidden");
                hasShaken = true;
                requestAnimationFrame(() => {
                    setupScrollAnimations();
                });
            }
        };

        start.addEventListener("click", () => {
            if (hasShaken) return;
            story.classList.remove("hidden");
            start.classList.add("hidden");
            hasShaken = true;
            requestAnimationFrame(() => {
                setupScrollAnimations();
            });
        });
        window.addEventListener("devicemotion", (event: DeviceMotionEvent) => {
            handleMotionEvent(event);
        });
    }
</script>
